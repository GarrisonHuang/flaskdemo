<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PM25-Chart</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.6.0/echarts.min.js"></script>

</head>

<!-- https://echarts.apache.org/ -->

<body>
    <a href="/">回首頁</a>

    <h1>PM2.5圖形繪製</h1>
    <div id="main" style="width: 1024px; height: 400px;"></div>
    <script>

        $.ajax({
            url: "/six-pm25-data",
            type: "GET",
            dataType: "json",
            success: (data) => {
                console.log(data); // 有資料就會印出 {site: [...], pm25: [...]}

                // 呼叫 drawChart，把資料畫出來！
                drawChart(myChart, data.site, data.pm25, "全省 PM2.5 數據", "PM2.5");
                //drawChart(chart1, data["site"], data["pm25"], title = "全省 PM2.5 數據");
            },
            error: (xhr, status, err) => {
                console.log("讀取失敗", err);
            }
        });

        //document.querySelector("h1").innerText = "123";
        //$("h1").text("<u>ABC</u>");
        $("h1").css("text-align", "center");
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));

        function drawChart(chart, xdata, ydata, title = "圖表", name = "數值") {
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: title
                },
                tooltip: {},
                legend: {
                    data: [name]
                },
                xAxis: {
                    data: xdata
                },
                yAxis: {},
                series: [
                    {
                        name: name,
                        type: 'bar',
                        data: ydata
                    }
                ]
            };

            // 使用刚指定的配置项和数据显示图表。
            chart.setOption(option);
        }
    </script>

</body>

</html>